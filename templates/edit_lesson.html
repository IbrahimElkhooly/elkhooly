{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4 text-primary">ğŸ“ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯Ø±Ø³</h2>

    <form action="{{ url_for('edit_lesson', lesson_id=lesson.id) }}" method="POST" class="bg-light p-4 rounded shadow">
        <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
        <div class="row g-4 mb-5">
            <div class="col-md-8">
                <div class="form-group mb-4">
                    <label for="title" class="form-label fw-bold">ğŸ·ï¸ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³</label>
                    <input type="text" id="title" name="title"
                           class="form-control form-control-lg"
                           value="{{ lesson.title }}" required>
                </div>

                <div class="form-group mb-4">
                    <label for="content" class="form-label fw-bold">ğŸ“„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯Ø±Ø³</label>
                    <textarea id="content" name="content"
                              class="form-control"
                              rows="5" required>{{ lesson.content }}</textarea>
                </div>
<input type="hidden" id="num_questions" name="num_questions" value="{{ quiz_data|length }}">

                <div class="form-group mb-4">
                    <label for="video_url" class="form-label fw-bold">ğŸ¥ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <input type="url" id="video_url" name="video_url"
                           class="form-control"
                           placeholder="https://www.youtube.com/watch?v=..."
                           value="{{ lesson.video_url }}">
                    <small class="text-muted">Ù…Ø«Ø§Ù„: https://www.youtube.com/watch?v=xxxx</small>
                </div>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
        <h4 class="border-bottom pb-2 mb-4">â“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h4>

        {% for i, question in enumerate(quiz_data) %}
        <div class="question-block bg-white p-4 mb-4 rounded border">
            <div class="row g-3">
                <div class="col-md-8">
                    <div class="form-group">
                        <label class="form-label fw-bold">Ø§Ù„Ø³Ø¤Ø§Ù„ {{ i+1 }}</label>
                        <input type="text" name="question_{{ i }}"
                               class="form-control"
                               value="{{ question.question }}" required>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group">
                        <label class="form-label fw-bold">ğŸ“ Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„</label>
                        <select name="type_{{ i }}" class="form-select">
                            <option value="text" {% if question.type =='text' %}selected{% endif %}>Ù†Øµ</option>
                            <option value="mcq" {% if question.type =='mcq' %}selected{% endif %}>Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯</option>
                        </select>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label fw-bold">âœ… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©</label>
                        <input type="text" name="correct_{{ i }}"
                               class="form-control"
                               value="{{ question.correct_answer }}" required>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label fw-bold">ğŸ’¬ Ø§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø±Ø§Ø¬Ø¹Ø©</label>
                        <input type="text" name="feedback_{{ i }}"
                               class="form-control"
                               value="{{ question.feedback }}"
                               placeholder="(Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                    </div>
                </div>

                {% if question.type == "mcq" %}
                <div class="col-12">
                    <div class="form-group">
                        <label class="form-label fw-bold">ğŸ”˜ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª</label>
                        <div class="row g-2">
                            {% for j in range(4) %}
                            <div class="col-md-6">
                                <div class="input-group mb-2">
                                    <span class="input-group-text">{{ loop.index }}</span>
                                    <input type="text"
                                           name="option_{{ i }}_{{ j+1 }}"
                                           class="form-control"
                                           value="{{ question.options[j] if question.options|length > j else '' }}">
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}

        <!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
        <div class="d-flex gap-3 mt-5">
            <button type="submit" class="btn btn-lg btn-success">
                ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
            </button>
            <a href="{{ url_for('lesson_details', lesson_id=lesson.id) }}"
               class="btn btn-lg btn-outline-secondary">
                âŒ Ø¥Ù„ØºØ§Ø¡
            </a>
        </div>
    </form>
</div>

<style>
    .question-block {
        transition: all 0.3s ease;
        background: #f8f9fa;
    }

    .question-block:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .form-label {
        color: #2c3e50;
    }

    .input-group-text {
        background: #e9ecef;
        min-width: 40px;
        justify-content: center;
    }
</style>
{% endblock %}