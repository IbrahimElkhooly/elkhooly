{% extends "base.html" %}
{% block content %}
<h2>ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†: {{ exam.exam_name }} - {{ exam.subject_name }}</h2>

<!-- âœ… Ø§Ù„ØªØ§Ø¨Ø§Øª -->
<ul class="nav nav-tabs" id="examTabs">
    <li class="nav-item">
        <a class="nav-link active" id="exam-details-tab" data-toggle="tab" href="#exam-details">ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="student-results-tab" data-toggle="tab" href="#student-results">ğŸ“ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="question-analysis-tab" data-toggle="tab" href="#question-analysis">ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</a>
    </li>
</ul>

<div class="tab-content mt-3">
    <!-- âœ… ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† -->
    <div class="tab-pane fade show active" id="exam-details">
        <h3>ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</h3>
        <ul>
            <li><strong>Ø§Ø³Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</strong> {{ exam.exam_name }}</li>
            <li><strong>Ø§Ù„Ù…Ø§Ø¯Ø©:</strong> {{ exam.subject_name }}</li>
        </ul>
    </div>

    <!-- âœ… Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨ -->
    <div class="tab-pane fade" id="student-results">
        <h3>ğŸ“ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨</h3>
        <table class="table table-bordered">
            <thead>
                <tr>
                   <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                    <th>Ø§Ù„Ø¯Ø±Ø¬Ø©</th>
                    <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</th>
                    <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØµØ­ÙŠØ­</th>
                    <th>ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø¡</th>
                    <th>ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</th>
                    <th>Ø§Ù„Ù…Ø¯Ø©</th>
                </tr>
            </thead>
            <tbody>
    {% for student in students %}
                <tr>
                     <td>{{ student.username }}</td>
                    <td>{{ student.score }}</td>
                    <td>{{ student.total_questions }}</td>
                    <td>{{ student.grade_date }}</td>
                    <td>{{ student.start_time }}</td>
                    <td>{{ student.end_time }}</td>
                    <td>{{ student.duration }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- âœ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
    <div class="tab-pane fade" id="question-analysis">
        <h3>ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h3>
        <table class="table table-bordered">
            <thead>
                <tr>
                                <th>Ø§Ù„Ø³Ø¤Ø§Ù„</th>
                    <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</th>
                    <th>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©</th>
                    <th>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø®Ø§Ø·Ø¦Ø©</th>
                    <th>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¯Ù‚Ø©</th>
                </tr>
            </thead>
            <tbody>
                {% for question in questions_analysis %}
    <tr>
        <td>{{ question.question_text }}</td>
        <td>{{ question.total_answers }}</td>
        <td>{{ question.correct_answers }}</td>
        <td>{{ question.wrong_answers }}</td>
        <td>{{ question.accuracy_percentage }}%</td>
    </tr>
    {% endfor %}
            </tbody>
        </table>
    </div>
</div>


<a href="{{ url_for('detailed_report', exam_id=exam_id) }}" class="btn btn-primary">ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„ Ù„ÙƒÙ„ Ø·Ø§Ù„Ø¨</a>

<!-- âœ… Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØªØ¨Ø© JavaScript Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ§Ø¨Ø§Øª -->
<script>




    document.addEventListener("DOMContentLoaded", function() {
        let tabs = document.querySelectorAll(".nav-link");
        tabs.forEach(tab => {
            tab.addEventListener("click", function(event) {
                event.preventDefault();
                let activeTab = document.querySelector(".tab-pane.active");
                let activeNav = document.querySelector(".nav-link.active");

                activeTab.classList.remove("show", "active");
                activeNav.classList.remove("active");

                let target = document.querySelector(this.getAttribute("href"));
                this.classList.add("active");
                target.classList.add("show", "active");
            });
        });
    });
</script>

{% endblock %}
